(function(p,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(p=typeof globalThis<"u"?globalThis:p||self,e(p.LazyMedia={},p.Vue))})(this,function(p,e){"use strict";const w=["src","alt"],M={key:1,class:"lazy-image-placeholder"},z=e.defineComponent({__name:"LazyImage",props:{src:{},alt:{default:""},sizes:{default:()=>[100,400]},rootMargin:{default:"50px"},threshold:{default:.1}},setup(f){const c=f,d=e.ref(null),r=e.ref(null),i=e.ref(!1),s=e.ref(!1),u=e.ref(null),k=n=>{const l=new URL(c.src,window.location.origin);return l.searchParams.set("size",n.toString()),l.toString()},t=(n,l)=>new Promise((a,m)=>{const h=new Image,g=()=>{h.onload=null,h.onerror=null};l&&l.addEventListener("abort",()=>{g(),h.src="",m(new DOMException("Aborted","AbortError"))}),h.onload=()=>{g(),a(n)},h.onerror=()=>{g(),m(new Error(`Failed to load: ${n}`))},h.src=n}),o=async()=>{u.value&&u.value.abort(),u.value=new AbortController;const n=u.value.signal,l=t(c.src,n).then(a=>{var m;r.value=a,i.value=!0,(m=u.value)==null||m.abort()}).catch(()=>{});for(const a of c.sizes){if(n.aborted||i.value)break;try{const m=k(a),h=await t(m,n);i.value||(r.value=h)}catch(m){if(m instanceof DOMException&&m.name==="AbortError")break}}await l};let y=null;return e.onMounted(()=>{d.value&&(y=new IntersectionObserver(n=>{n[0].isIntersecting&&!s.value&&(s.value=!0,o())},{rootMargin:c.rootMargin,threshold:c.threshold}),y.observe(d.value))}),e.onUnmounted(()=>{var n;y==null||y.disconnect(),(n=u.value)==null||n.abort()}),e.watch(()=>c.src,()=>{s.value&&(r.value=null,i.value=!1,o())}),(n,l)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"containerRef",ref:d,class:"lazy-image-container"},[r.value?(e.openBlock(),e.createElementBlock("img",{key:0,src:r.value,alt:n.alt,class:e.normalizeClass(["lazy-image",{loaded:i.value}])},null,10,w)):(e.openBlock(),e.createElementBlock("div",M,[e.renderSlot(n.$slots,"placeholder",{},()=>[l[0]||(l[0]=e.createElementVNode("span",{class:"lazy-image-spinner"},null,-1))])]))],512))}}),I={key:0,class:"lazy-video-placeholder"},R=["src","alt"],$={key:1,class:"lazy-video-icon"},b=["src","poster","controls","autoplay","muted","loop","preload"],B=e.defineComponent({__name:"LazyVideo",props:{src:{},poster:{},alt:{default:""},controls:{type:Boolean,default:!0},autoplay:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},preload:{default:"metadata"},rootMargin:{default:"50px"},threshold:{default:.1}},setup(f,{expose:c}){const d=f,r=e.ref(null),i=e.ref(null),s=e.ref(!1),u=e.ref(!1),k=()=>{u.value=!0};let t=null;return e.onMounted(()=>{r.value&&(t=new IntersectionObserver(o=>{o[0].isIntersecting&&!s.value&&(s.value=!0,t==null||t.disconnect())},{rootMargin:d.rootMargin,threshold:d.threshold}),t.observe(r.value))}),e.onUnmounted(()=>{t==null||t.disconnect()}),c({video:i}),(o,y)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"containerRef",ref:r,class:"lazy-video-container"},[s.value?(e.openBlock(),e.createElementBlock("video",{key:1,ref_key:"videoRef",ref:i,src:o.src,poster:o.poster,controls:o.controls,autoplay:o.autoplay,muted:o.muted,loop:o.loop,preload:o.preload,class:"lazy-video",onLoadeddata:k},[e.renderSlot(o.$slots,"default")],40,b)):(e.openBlock(),e.createElementBlock("div",I,[e.renderSlot(o.$slots,"placeholder",{},()=>[o.poster?(e.openBlock(),e.createElementBlock("img",{key:0,src:o.poster,alt:o.alt,class:"lazy-video-poster"},null,8,R)):(e.openBlock(),e.createElementBlock("span",$,"â–¶"))])]))],512))}}),S={key:0,class:"lazy-audio-placeholder"},D=["src","controls","autoplay","muted","loop","preload"],L=e.defineComponent({__name:"LazyAudio",props:{src:{},controls:{type:Boolean,default:!0},autoplay:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},preload:{default:"metadata"},rootMargin:{default:"50px"},threshold:{default:.1}},setup(f,{expose:c}){const d=f,r=e.ref(null),i=e.ref(null),s=e.ref(!1),u=e.ref(!1),k=()=>{u.value=!0};let t=null;return e.onMounted(()=>{r.value&&(t=new IntersectionObserver(o=>{o[0].isIntersecting&&!s.value&&(s.value=!0,t==null||t.disconnect())},{rootMargin:d.rootMargin,threshold:d.threshold}),t.observe(r.value))}),e.onUnmounted(()=>{t==null||t.disconnect()}),c({audio:i}),(o,y)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"containerRef",ref:r,class:"lazy-audio-container"},[s.value?(e.openBlock(),e.createElementBlock("audio",{key:1,ref_key:"audioRef",ref:i,src:o.src,controls:o.controls,autoplay:o.autoplay,muted:o.muted,loop:o.loop,preload:o.preload,class:"lazy-audio",onLoadeddata:k},[e.renderSlot(o.$slots,"default")],40,D)):(e.openBlock(),e.createElementBlock("div",S,[e.renderSlot(o.$slots,"placeholder",{},()=>[y[0]||(y[0]=e.createElementVNode("span",{class:"lazy-audio-icon"},"ðŸŽµ",-1))])]))],512))}}),V={key:0,class:"lazy-document-placeholder"},T={class:"lazy-document-icon"},C={class:"lazy-document-filename"},U=["src","title"],A=["data","type"],N=["href","download"],_=e.defineComponent({__name:"LazyDocument",props:{src:{},title:{default:"Document"},useIframe:{type:Boolean,default:!1},downloadText:{default:"Download"},rootMargin:{default:"50px"},threshold:{default:.1}},setup(f){const c=f,d=e.ref(null),r=e.ref(null),i=e.ref(null),s=e.ref(!1),u=e.ref(!1),k=e.computed(()=>{try{return new URL(c.src,window.location.origin).pathname.split("/").pop()||"document"}catch{return"document"}}),t=e.computed(()=>{var h;return((h=k.value.split(".").pop())==null?void 0:h.toLowerCase())||""}),o=e.computed(()=>({pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",txt:"text/plain",csv:"text/csv",rtf:"application/rtf"})[t.value]||"application/octet-stream"),y=e.computed(()=>({pdf:"ðŸ“„",doc:"ðŸ“",docx:"ðŸ“",xls:"ðŸ“Š",xlsx:"ðŸ“Š",ppt:"ðŸ“½ï¸",pptx:"ðŸ“½ï¸",txt:"ðŸ“ƒ",csv:"ðŸ“Š",rtf:"ðŸ“"})[t.value]||"ðŸ“"),n=()=>{u.value=!0};let l=null;return e.onMounted(()=>{d.value&&(l=new IntersectionObserver(a=>{a[0].isIntersecting&&!s.value&&(s.value=!0,l==null||l.disconnect())},{rootMargin:c.rootMargin,threshold:c.threshold}),l.observe(d.value))}),e.onUnmounted(()=>{l==null||l.disconnect()}),(a,m)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"containerRef",ref:d,class:"lazy-document-container"},[s.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[a.useIframe?(e.openBlock(),e.createElementBlock("iframe",{key:0,ref_key:"iframeRef",ref:r,src:a.src,title:a.title,class:"lazy-document-iframe",onLoad:n},null,40,U)):(e.openBlock(),e.createElementBlock("object",{key:1,ref_key:"objectRef",ref:i,data:a.src,type:o.value,class:"lazy-document-object",onLoad:n},[e.createElementVNode("a",{href:a.src,download:k.value,class:"lazy-document-fallback"},e.toDisplayString(a.downloadText)+" "+e.toDisplayString(k.value),9,N)],40,A))],64)):(e.openBlock(),e.createElementBlock("div",V,[e.renderSlot(a.$slots,"placeholder",{},()=>[e.createElementVNode("div",T,[e.createElementVNode("span",null,e.toDisplayString(y.value),1),e.createElementVNode("span",C,e.toDisplayString(k.value),1)])])]))],512))}}),E={install(f){f.component("LazyImage",z),f.component("LazyVideo",B),f.component("LazyAudio",L),f.component("LazyDocument",_)}};p.LazyAudio=L,p.LazyDocument=_,p.LazyImage=z,p.LazyMediaPlugin=E,p.LazyVideo=B,p.default=E,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
